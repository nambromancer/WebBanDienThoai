@using PagedList
@using PagedList.Mvc
@model WebBanDienThoai.Models.ViewModel.SearchProductVM

@if (Model.Products != null && Model.Products.Any())
{
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th class="bg-success col-md-1">Hình ảnh</th>
                <th class="bg-success col-md-4">Tên sản phẩm</th>
                <th class="bg-success col-md-2">Đơn giá</th>
                <th class="bg-success col-md-3">Danh mục</th>
                <th class="bg-success col-md-2">Chức năng</th>
            </tr>
        </thead>

        <tbody>
            @foreach (var product in Model.Products)
            {
                <tr>
                    <td>
                        @{
                            var imgSrc = string.IsNullOrWhiteSpace(product.ProductImage)
                                ? Url.Content("~/Content/Images/no-image.png")
                                : Url.Content(product.ProductImage);
                        }
                        <img src="@imgSrc" alt="@product.ProductName" class="product-thumb img-thumbnail" style="max-width: 80px; max-height: 80px;" />
                    </td>
                    <td>@Html.DisplayFor(_ => product.ProductName)</td>
                    <td>@String.Format("{0:N0} VNĐ", product.ProductPrice)</td>
                    <td>
                        @if (product.Category != null)
                        {
                            <span class="badge bg-primary">@product.Category.CategoryName</span>
                        }
                    </td>
                    <td>
                        @Html.ActionLink("Cập nhật", "Edit", new { id = product.ProductID }, new { @class = "btn btn-primary btn-sm" })
                        @Html.ActionLink("Chi tiết", "Details", new { id = product.ProductID }, new { @class = "btn btn-info btn-sm mx-1" })
                        @Html.ActionLink("Xóa", "Delete", new { id = product.ProductID }, new { @class = "btn btn-danger btn-sm" })
                    </td>
                </tr>
            }
        </tbody>
    </table>

    @* Phân trang *@
    <div class="pagination-container text-center">
        @Html.PagedListPager(Model.Products, page => Url.Action("Index", new
        {
            page,
            searchTerm = Model.SearchTerm,
            minPrice = Model.MinPrice,
            maxPrice = Model.MaxPrice,
            categoryFilter = Model.CategoryFilter,
            sortOrder = Model.SortOrder
        }))

        <p class="text-muted mt-2">
            Trang @Model.Products.PageNumber / @Model.Products.PageCount | Tổng @Model.Products.TotalItemCount sản phẩm
        </p>
    </div>
}
else
{
    <div class="alert alert-warning">
        <i class="fas fa-exclamation-triangle"></i>
        Không tìm được sản phẩm nào phù hợp với bộ lọc.
    </div>
}

<div class="form-group mt-3">
    @Html.ActionLink("Thêm mới sản phẩm", "Create", null, new { @class = "btn btn-success" })
</div>

<style>
    /* Custom CSS cho phân trang */
    .pagination-container .pagination {
        display: inline-flex;
        padding-left: 0;
        list-style: none;
        border-radius: 0.25rem;
    }

        .pagination-container .pagination li {
            display: inline;
        }

            .pagination-container .pagination li a,
            .pagination-container .pagination li span {
                position: relative;
                display: block;
                padding: 0.5rem 0.75rem;
                margin-left: -1px;
                line-height: 1.25;
                color: #007bff;
                background-color: #fff;
                border: 1px solid #dee2e6;
                text-decoration: none;
            }

                .pagination-container .pagination li a:hover {
                    z-index: 2;
                    color: #0056b3;
                    background-color: #e9ecef;
                    border-color: #dee2e6;
                }

            .pagination-container .pagination li.active span {
                z-index: 3;
                color: #fff;
                background-color: #007bff;
                border-color: #007bff;
            }

            .pagination-container .pagination li.disabled span {
                color: #6c757d;
                pointer-events: none;
                cursor: auto;
                background-color: #fff;
                border-color: #dee2e6;
            }

            .pagination-container .pagination li:first-child a,
            .pagination-container .pagination li:first-child span {
                margin-left: 0;
                border-top-left-radius: 0.25rem;
                border-bottom-left-radius: 0.25rem;
            }

            .pagination-container .pagination li:last-child a,
            .pagination-container .pagination li:last-child span {
                border-top-right-radius: 0.25rem;
                border-bottom-right-radius: 0.25rem;
            }
</style>