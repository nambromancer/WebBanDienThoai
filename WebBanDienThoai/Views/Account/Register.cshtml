@model WebBanDienThoai.Models.RegisterViewModel
@{
    ViewBag.Title = "Đăng ký";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/register-tgdd.css" rel="stylesheet" />

<div class="register-wrap">
    <h1 class="register-title">Đăng ký trở thành thành viên thegioididong</h1>

    @using (Html.BeginForm("Register", "Account", FormMethod.Post, new { @class = "register-form", role = "form", novalidate = "novalidate" }))
    {
        @Html.AntiForgeryToken()

        @* BỎ ValidationSummary để không hiện khung đỏ *@
        @*@Html.ValidationSummary(true, "", new { @class = "text-danger" })*@

        if (TempData["ErrorMessage"] != null)
        {
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-circle"></i> @TempData["ErrorMessage"]
            </div>
        }

        <fieldset class="section">
            <legend class="section-title">Thông tin cá nhân</legend>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.FullName)
                        <span class="required">*</span>
                        @Html.TextBoxFor(m => m.FullName, new
                        {
                            @class = "form-control",
                            placeholder = "VD: Nguyễn Văn A",
                            autocomplete = "name",
                            maxlength = "100"
                        })
                        @Html.ValidationMessageFor(m => m.FullName, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.BirthDate)
                        @Html.TextBoxFor(m => m.BirthDate, "{0:yyyy-MM-dd}", new
                        {
                            @class = "form-control",
                            type = "date",
                            max = DateTime.Now.AddYears(-10).ToString("yyyy-MM-dd"),
                            min = DateTime.Now.AddYears(-100).ToString("yyyy-MM-dd")
                        })
                        @Html.ValidationMessageFor(m => m.BirthDate, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.PhoneNumber)
                        <span class="required">*</span>
                        @Html.TextBoxFor(m => m.PhoneNumber, new
                        {
                            @class = "form-control",
                            placeholder = "VD: 0912345678",
                            type = "tel",
                            autocomplete = "tel",
                            maxlength = "10"
                        })
                        @Html.ValidationMessageFor(m => m.PhoneNumber, "", new { @class = "text-danger" })
                        <small class="form-text text-muted">Số điện thoại sẽ dùng để đăng nhập</small>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Email)
                        @Html.TextBoxFor(m => m.Email, new
                        {
                            @class = "form-control",
                            placeholder = "VD: example@email.com",
                            type = "email",
                            autocomplete = "email"
                        })
                        @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Gender)
                        <span class="required">*</span>
                        @Html.DropDownListFor(m => m.Gender, new SelectList(new[] {
                            new { Value = "", Text = "-- Chọn giới tính --" },
                            new { Value = "Nam", Text = "Nam" },
                            new { Value = "Nữ", Text = "Nữ" },
                            new { Value = "Khác", Text = "Khác" }
                        }, "Value", "Text"), new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.Gender, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset class="section">
            <legend class="section-title">Mật khẩu</legend>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Password)
                        <span class="required">*</span>
                        @Html.PasswordFor(m => m.Password, new
                        {
                            @class = "form-control",
                            placeholder = "Nhập mật khẩu",
                            autocomplete = "new-password"
                        })
                        @Html.ValidationMessageFor(m => m.Password, "", new { @class = "text-danger" })
                        <small class="form-text text-muted">
                            Mật khẩu phải có ít nhất 6 ký tự, bao gồm chữ hoa, chữ thường và số
                        </small>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.ConfirmPassword)
                        <span class="required">*</span>
                        @Html.PasswordFor(m => m.ConfirmPassword, new
                        {
                            @class = "form-control",
                            placeholder = "Nhập lại mật khẩu",
                            autocomplete = "new-password"
                        })
                        @Html.ValidationMessageFor(m => m.ConfirmPassword, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>
        </fieldset>

        <div class="actions">
            <button type="submit" class="btn btn-tgdd">
                <i class="fas fa-user-plus"></i> Đăng ký
            </button>
            <a href="@Url.Action("Index", "Home")" class="btn btn-secondary">
                <i class="fas fa-home"></i> Quay lại
            </a>
        </div>

        <div class="signup">
            <span>Bạn đã có tài khoản?</span>
            <a href="@Url.Action("Login","Account")" class="signup-link">Đăng nhập ngay</a>
        </div>
    }
</div>

@section scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <style>
        .required {
            color: red;
            font-weight: bold;
        }

        .form-text.text-muted {
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }

        .alert {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 5px;
        }

        .alert-danger {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        .actions {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-tgdd {
            background: linear-gradient(to bottom, #fdd835, #f9a825);
            color: #333;
        }

            .btn-tgdd:hover {
                background: linear-gradient(to bottom, #f9a825, #f57f17);
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

            .btn-secondary:hover {
                background-color: #5a6268;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            }

        .signup {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }

            .signup span {
                color: #666;
                font-size: 14px;
            }

        .signup-link {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            margin-left: 5px;
        }

            .signup-link:hover {
                text-decoration: underline;
            }
    </style>

    <script>
        $(document).ready(function () {
            // Custom validation để cho phép họ tên có dấu tiếng Việt
            $.validator.addMethod("vietnamesename", function (value, element) {
                return this.optional(element) || /^[a-zA-ZÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵýỷỹ\s]+$/.test(value);
            }, "Họ tên chỉ được chứa chữ cái và khoảng trắng");

            $("input[name='FullName']").rules("add", {
                vietnamesename: true
            });
        });
    </script>
}