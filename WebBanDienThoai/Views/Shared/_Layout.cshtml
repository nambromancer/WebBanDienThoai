<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <!-- Viewport để responsive trên mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tiêu đề trang: phần sau dấu gạch sẽ cố định -->
    <title>@ViewBag.Title - Thế Giới Di Động</title>

    @Styles.Render("~/Content/css")
    <!-- CSS header/footer/modal tách riêng để dễ bảo trì -->
    <link href="~/Content/header-style.css" rel="stylesheet" />
    <link href="~/Content/footer-style.css" rel="stylesheet" />
    <link href="~/Content/modal-tgdd.css" rel="stylesheet" />

    @Scripts.Render("~/bundles/modernizr")
</head>
<body>
    <!-- Header chính của site -->
    <header class="main-header" role="banner">
        <div class="header-container">
            <!-- Khu vực logo (về trang chủ) -->
            <div class="logo-section">
                <a href="@Url.Action("Index", "Home")" class="logo-link" aria-label="Về trang chủ">
                    <div class="logo-circle">
                        <span class="logo-icon">📱</span>
                    </div>
                    <span class="logo-text">thegioididong</span>
                </a>
            </div>

            <!-- Thanh tìm kiếm (chỉ là UI demo, chưa submit form) -->
            <div class="search-section" role="search" aria-label="Tìm kiếm">
                <div class="search-container">
                    <!-- aria-label để screen reader hiểu mục đích -->
                    <input type="text" class="search-input" placeholder="Laptop nhập học..." aria-label="Từ khóa tìm kiếm">
                    <!-- type="button" tránh submit form mặc định -->
                    <button class="search-btn" type="button" aria-label="Tìm kiếm">
                        <span class="search-icon">🔍</span>
                    </button>
                </div>
            </div>

            <!-- Hành động người dùng -->
            <div class="user-actions" aria-label="Tác vụ người dùng">
                <!-- Dùng cả data-* của BS3/4/5 để tương thích tối đa -->
                <a id="loginLink"
                   href="javascript:void(0)"
                   class="user-login"
                   data-toggle="modal" data-target="#loginModal"
                   data-bs-toggle="modal" data-bs-target="#loginModal">
                    <span class="user-icon">👤</span>
                    <span>Đăng nhập</span>
                </a>
                <a href="#" class="cart-link" aria-label="Xem giỏ hàng">
                    <span class="cart-icon">🛒</span>
                    <span>Giỏ hàng</span>
                </a>
                <div class="location" aria-label="Vị trí hiện tại">
                    <span class="location-icon">📍</span>
                    <span>Hồ Chí Minh</span>
                </div>
            </div>
        </div>

        <!-- Menu điều hướng chính -->
        <nav class="main-navigation" aria-label="Danh mục chính">
            <div class="nav-container">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="@Url.Action("Index", "Home")" class="nav-link">
                            <span class="nav-icon">📱</span>
                            Điện thoại
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">💻</span>
                            Laptop
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">🔌</span>
                            Phụ kiện
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">⌚</span>
                            Smartwatch
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">📱</span>
                            Tablet
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">♻️</span>
                            Máy cũ, Thu cũ
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">📶</span>
                            Sim, thẻ cào
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Modal đăng nhập (tương thích BS3/4/5) -->
    <div class="modal fade tgdd-modal"
         id="loginModal"
         tabindex="-1"
         role="dialog"
         aria-labelledby="loginModalLabel"
         aria-modal="true"
         aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <!-- Nút đóng: giữ class/data-* để Bootstrap hook -->
                <button type="button"
                        class="close tgdd-close"
                        data-dismiss="modal"
                        data-bs-dismiss="modal"
                        aria-label="Đóng">
                    x
                </button>
                <div class="modal-body text-center">
                    <h3 id="loginModalLabel" class="tgdd-title">thegioididong</h3>
                    <p class="tgdd-desc">
                        Vui lòng đăng nhập tài khoản thegioididong để xem ưu đãi và thanh toán dễ dàng hơn.
                    </p>
                    <div class="tgdd-actions">
                        <!-- Dùng Url.Action để dẫn đến trang tài khoản -->
                        <a href="@Url.Action("Register", "Account")" class="btn btn-outline-tgdd">Đăng ký</a>
                        <a href="@Url.Action("Login", "Account")" class="btn btn-tgdd">Đăng nhập</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Khu vực nội dung chính -->
    <div class="container body-content">
        @RenderBody() <!-- Nơi inject View con -->
        <hr />
    </div>

    <!-- Footer của site -->
    <footer role="contentinfo">
        <div class="footer-top">
            <div class="footer-container">
                <div class="footer-columns">
                    <div class="footer-col">
                        <h4>Tổng đài hỗ trợ</h4>
                        <ul>
                            <li>Gọi mua: <a href="tel:18001060">1800 1060</a> (7:30 - 22:00)</li>
                            <li>Khiếu nại: <a href="tel:18001062">1800 1062</a> (8:00 - 21:30)</li>
                            <li>Bảo hành: <a href="tel:18001064">1800 1064</a> (8:00 - 21:00)</li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Về công ty</h4>
                        <ul>
                            <li><a href="#">Giới thiệu công ty (MWG.vn)</a></li>
                            <li><a href="#">Tuyển dụng</a></li>
                            <li><a href="#">Gửi góp ý, khiếu nại</a></li>
                            <li><a href="#">Tìm siêu thị (gần bạn)</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Thông tin khác</h4>
                        <ul>
                            <li><a href="#">Trung tâm bảo hành</a></li>
                            <li><a href="#">Chính sách bảo hành</a></li>
                            <li><a href="#">Hướng dẫn mua hàng</a></li>
                            <li><a href="#">Bảo mật và điều khoản</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Website cùng tập đoàn</h4>
                        <div class="partner-badges">
                            <a href="#" class="badge">TopZone</a>
                            <a href="#" class="badge">Điện máy XANH</a>
                            <a href="#" class="badge">Bách hóa XANH</a>
                            <a href="#" class="badge">Nhà thuốc An Khang</a>
                        </div>
                        <div class="socials">
                            <a href="#" class="social">Facebook</a>
                            <a href="#" class="social">YouTube</a>
                            <a href="#" class="social">Zalo</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-container">
                <!-- Năm hiện tại lấy từ server -->
                <p>© @DateTime.Now.Year - Thế Giới Di Động. Nội dung mang tính minh họa cho bài thực hành.</p>
            </div>
        </div>
    </footer>

    <!-- Bundle script: jQuery trước Bootstrap để đảm bảo phụ thuộc -->
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    <!-- Cho phép View con chèn script riêng -->
    @RenderSection("scripts", required: false)

    <!-- JS mở/đóng modal: fallback cho cả BS3/4/5 và không Bootstrap -->
    <script>
        (function () {
            'use strict';

            // Mở modal đăng nhập
            function showLoginModal(e) {
                if (e) e.preventDefault();
                var modalEl = document.getElementById('loginModal');
                if (!modalEl) return;

                // Ưu tiên jQuery (BS3/4)
                if (window.jQuery && typeof jQuery.fn.modal === 'function') {
                    jQuery(modalEl).modal('show');
                    return;
                }
                // BS5 (không cần jQuery)
                if (window.bootstrap && typeof bootstrap.Modal === 'function') {
                    (bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl)).show();
                    return;
                }
                // Fallback đơn giản nếu không có Bootstrap
                modalEl.classList.add('in', 'show');
                modalEl.style.display = 'block';
                modalEl.setAttribute('aria-hidden', 'false');
                document.body.classList.add('modal-open');
            }

            // Đóng modal đăng nhập
            function hideLoginModal(e) {
                if (e) e.preventDefault();
                var modalEl = document.getElementById('loginModal');
                if (!modalEl) return;

                if (window.jQuery && typeof jQuery.fn.modal === 'function') {
                    jQuery(modalEl).modal('hide');
                    return;
                }
                if (window.bootstrap && typeof bootstrap.Modal === 'function') {
                    (bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl)).hide();
                    return;
                }
                // Fallback: ẩn thủ công và dọn backdrop
                modalEl.classList.remove('in', 'show');
                modalEl.style.display = 'none';
                modalEl.setAttribute('aria-hidden', 'true');
                document.body.classList.remove('modal-open');
                var backdrop = document.querySelector('.modal-backdrop');
                if (backdrop && backdrop.parentNode) backdrop.parentNode.removeChild(backdrop);
            }

            // Mở modal khi click nút đăng nhập (dù data-* có hoạt động hay không)
            document.addEventListener('click', function (ev) {
                var trigger = ev.target && ev.target.closest ? ev.target.closest('#loginLink') : null;
                if (trigger) showLoginModal(ev);
            });

            // Đóng modal khi click nút close (ưu tiên jQuery delegation nếu có)
            if (window.jQuery) {
                jQuery(document).on('click', '#loginModal .tgdd-close', hideLoginModal);
            } else {
                document.addEventListener('click', function (ev) {
                    var closeBtn = ev.target && ev.target.closest ? ev.target.closest('#loginModal .tgdd-close') : null;
                    if (closeBtn) hideLoginModal(ev);
                });
            }
        })();
    </script>
</body>
</html>